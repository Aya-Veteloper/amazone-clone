<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Cart</title>
</head>

<body>
    <div class="cart-container">
        <h1>Shopping Cart</h1>
        <a href="">Deselect all items</a>
        <p>Price</p>
        <ul id="cart-list">
            <!-- You Can add by javascript -->
        </ul>
        <div class="checkout">
            <button>Proceed to checkout</button>
            <p>Total: <span id="total-price">$195.95</span></p>
        </div>
    </div>
    </div>
    <script>
        const cartList = document.querySelector('#cart-list');
        window.addEventListener("load", function () {

            const xhr = new XMLHttpRequest();
            xhr.open("GET", "product.json", true);

            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    const data = JSON.parse(xhr.responseText);

                    console.log(data);
                    const cart = []

                    const productIDs = JSON.parse(localStorage.getItem("productCardIDs")) || [];
                    console.log(productIDs)

                    const productDetails = data.filter(product => productIDs.includes(product.id.toString()));
                    console.log(productDetails);

                    // Filter products based on the search term
                    productDetails.forEach(product => {
                        cart.push(product);
                        ShowInCart(product);
                    });
                }
            }
            xhr.send();
        })

        function ShowInCart(product) {

            if (product) {
                const item = document.createElement("li");
                item.innerHTML = `<img src=${product.images} alt="">
                    <div class="item-details">

                        <h3>${product.title}</h3>
                        <p>In Stock</p>
                        <select name="" id="">
                            <option value="1">Qty:1</option>
                            <option value="2">Qty:2</option>
                            <option value="3">Qty:3</option>
                            <option value="4">Qty:4</option>
                            <option value="5">Qty:5</option>
                        </select>
                        <button>Delete</button>
                        <button>Save for later</button>
                    </div>
                    <div class="item-price">
                        <p>$${product.price}</p>
                        <div class="coupon">
                            <p>Save 10%</p>
                            <a href="">Clip Coupon</a>
                        </div>
                    </div>`;
                cartList.appendChild(item);
            }
        }

        // const cartList = document.querySelector('#cart-list');

        // window.addEventListener("load", function () {
        //     // Retrieve an array of product IDs from local storage
        //     const productIDs = JSON.parse(localStorage.getItem("productCardIDs")) || [];

        //     // Fetch the product data
        //     fetch("product.json")
        //         .then(response => response.json())
        //         .then(data => {
        //             const cart = [];

        //             console.log(data);
        //             // Filter products based on the stored product IDs
        //             const productDetails = data.filter(product => productIDs.includes(product.id));
        //             console.log(productDetails);

        //             // Display products in the cart
        //             productDetails.forEach(product => {
        //                 cart.push(product);
        //                 ShowInCart(product);
        //             });
        //         })
        //         .catch(error => console.error('Error fetching product data:', error));
        // });

        // function ShowInCart(product) {
        //     const item = document.createElement("li");
        //     item.innerHTML = `<img src=${product.images} alt="">
        // <div class="item-details">
        //     <h3>${product.title}</h3>
        //     <p>In Stock</p>
        //     <select name="" id="">
        //         <option value="1">Qty:1</option>
        //         <option value="2">Qty:2</option>
        //         <option value="3">Qty:3</option>
        //         <option value="4">Qty:4</option>
        //         <option value="5">Qty:5</option>
        //     </select>
        //     <button>Delete</button>
        //     <button>Save for later</button>
        // </div>
        // <div class="item-price">
        //     <p>$${product.price}</p>
        //     <div class="coupon">
        //         <p>Save 10%</p>
        //         <a href="">Clip Coupon</a>
        //     </div>
        // </div>`;
        //     cartList.appendChild(item);
        // }


    </script>

    <link rel="stylesheet" href="cart.css">
</body>

</html>